Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 24.699904
Epoch 1
Validation mse = 22.534409
Epoch 2
Validation mse = 16.866505
Epoch 3
Validation mse = 7.737882
Epoch 4
Validation mse = 0.207668
Epoch 5
Validation mse = 0.390368
Epoch 6
Validation mse = 0.139902
Epoch 7
Validation mse = 0.685889
Epoch 8
Validation mse = 1.374685
Epoch 9
Validation mse = 1.647774
Epoch 10
Validation mse = 0.867539
Epoch 11
Validation mse = 0.170343
Epoch 12
Validation mse = 0.323609
Epoch 13
Validation mse = 0.189276
Epoch 14
Validation mse = 0.177469
Epoch 15
Validation mse = 0.339282
Epoch 16
Validation mse = 0.355276
Epoch 17
Validation mse = 0.196667
Epoch 18
Validation mse = 0.168445
Epoch 19
Validation mse = 0.181946
Epoch 20
Validation mse = 0.346439
Epoch 21
Validation mse = 0.555675
Epoch 22
Validation mse = 0.598611
Epoch 23
Validation mse = 0.351925
Epoch 24
Validation mse = 0.169031
Epoch 25
Validation mse = 0.137945
Epoch 26
Validation mse = 0.232766
Epoch 27
Validation mse = 0.403456
Epoch 28
Validation mse = 0.362070
Epoch 29
Validation mse = 0.352749
Epoch 30
Validation mse = 0.242504
Epoch 31
Validation mse = 0.283195
Epoch 32
Validation mse = 0.465960
Epoch 33
Validation mse = 0.536258
Epoch 34
Validation mse = 0.661931
Epoch 35
Validation mse = 0.479549
Epoch 36
Validation mse = 0.482480
Epoch 37
Validation mse = 0.556210
Epoch 38
Validation mse = 0.470267
Epoch 39
Validation mse = 0.381124
Epoch 40
Validation mse = 0.329246
Epoch 41
Validation mse = 0.379629
Epoch 42
Validation mse = 0.285895
Epoch 43
Validation mse = 0.261821
Epoch 44
Validation mse = 0.250420
Epoch 45
Validation mse = 0.225017
Epoch 46
Validation mse = 0.281254
Epoch 47
Validation mse = 0.319354
Epoch 48
Validation mse = 0.328965
Epoch 49
Validation mse = 0.396283
Epoch 50
Validation mse = 0.392357
Epoch 51
Validation mse = 0.560601
Epoch 52
Validation mse = 1.068151
Epoch 53
Validation mse = 1.693596
Epoch 54
Validation mse = 2.031011
Epoch 55
Validation mse = 1.412570
Epoch 56
Validation mse = 0.571152
Epoch 57
Validation mse = 0.163942
Epoch 58
Validation mse = 0.135608
Epoch 59
Validation mse = 0.168117
Epoch 60
Validation mse = 0.133328
Epoch 61
Validation mse = 0.165065
Epoch 62
Validation mse = 0.357813
Epoch 63
Validation mse = 0.692082
Epoch 64
Validation mse = 1.117739
Epoch 65
Validation mse = 1.614340
Epoch 66
Validation mse = 1.588614
Epoch 67
Validation mse = 1.296223
Epoch 68
Validation mse = 0.605019
Epoch 69
Validation mse = 0.205474
Epoch 70
Validation mse = 0.119476
Epoch 71
Validation mse = 0.118616
Epoch 72
Validation mse = 0.130302
Epoch 73
Validation mse = 0.202134
Epoch 74
Validation mse = 0.368263
Epoch 75
Validation mse = 0.522281
Epoch 76
Validation mse = 0.610480
Epoch 77
Validation mse = 0.495658
Epoch 78
Validation mse = 0.400066
Epoch 79
Validation mse = 0.414593
Epoch 80
Validation mse = 0.598218
Epoch 81
Validation mse = 0.806722
Epoch 82
Validation mse = 0.962837
Epoch 83
Validation mse = 0.882120
Epoch 84
Validation mse = 0.671705
Epoch 85
Validation mse = 0.330765
Epoch 86
Validation mse = 0.151884
Epoch 87
Validation mse = 0.118391
Epoch 88
Validation mse = 0.122371
Epoch 89
Validation mse = 0.182629
Epoch 90
Validation mse = 0.413115
Epoch 91
Validation mse = 0.932022
Epoch 92
Validation mse = 1.257780
Epoch 93
Validation mse = 1.493993
Epoch 94
Validation mse = 1.412002
Epoch 95
Validation mse = 1.112596
Epoch 96
Validation mse = 0.771687
Epoch 97
Validation mse = 0.490551
Epoch 98
Validation mse = 0.412144
Epoch 99
Validation mse = 0.330284
Epoch 100
Validation mse = 0.318712
Epoch 101
Validation mse = 0.344424
Epoch 102
Validation mse = 0.514604
Epoch 103
Validation mse = 0.748725
Epoch 104
Validation mse = 0.811725
Epoch 105
Validation mse = 0.872852
Epoch 106
Validation mse = 0.934215
Epoch 107
Validation mse = 0.922613
Epoch 108
Validation mse = 0.946538
Epoch 109
Validation mse = 0.783958
Epoch 110
Validation mse = 0.370430
Epoch 111
Validation mse = 0.204367
Epoch 112
Validation mse = 0.173333
Epoch 113
Validation mse = 0.155365
Epoch 114
Validation mse = 0.202654
Epoch 115
Validation mse = 0.379781
Epoch 116
Validation mse = 0.687853
Epoch 117
Validation mse = 1.038808
Epoch 118
Validation mse = 1.296905
Epoch 119
Validation mse = 1.554190
Epoch 120
Validation mse = 1.630976
Epoch 121
Validation mse = 1.563740
Epoch 122
Validation mse = 1.144269
Epoch 123
Validation mse = 0.652995
Epoch 124
Validation mse = 0.290974
Epoch 125
Validation mse = 0.178488
Epoch 126
Validation mse = 0.164160
Epoch 127
Validation mse = 0.205582
Epoch 128
Validation mse = 0.381127
Epoch 129
Validation mse = 0.521454
Epoch 130
Validation mse = 0.836697
Epoch 131
Validation mse = 1.056235
Epoch 132
Validation mse = 1.029140
Epoch 133
Validation mse = 0.936040
Epoch 134
Validation mse = 0.770456
Epoch 135
Validation mse = 0.623755
Epoch 136
Validation mse = 0.424002
Epoch 137
Validation mse = 0.339181
Epoch 138
Validation mse = 0.334349
Epoch 139
Validation mse = 0.422333
Epoch 140
Validation mse = 0.644514
Epoch 141
Validation mse = 0.875257
Epoch 142
Validation mse = 0.922401
Epoch 143
Validation mse = 0.908010
Epoch 144
Validation mse = 1.114010
Epoch 145
Validation mse = 1.365278
Epoch 146
Validation mse = 1.563985
Epoch 147
Validation mse = 1.800637
Epoch 148
Validation mse = 1.434922
Epoch 149
Validation mse = 0.989628
Model 0 best validation mse = 0.118391 on epoch 87
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test mse = 0.184299
Building model 1
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 23.803370
Epoch 1
Validation mse = 19.643762
Epoch 2
Validation mse = 11.320804
Epoch 3
Validation mse = 1.475999
Epoch 4
Validation mse = 0.298454
Epoch 5
Validation mse = 0.527238
Epoch 6
Validation mse = 2.432248
Epoch 7
Validation mse = 3.666315
Epoch 8
Validation mse = 3.378472
Epoch 9
Validation mse = 1.888032
Epoch 10
Validation mse = 0.482522
Epoch 11
Validation mse = 0.471387
Epoch 12
Validation mse = 0.838096
Epoch 13
Validation mse = 0.663419
Epoch 14
Validation mse = 0.318386
Epoch 15
Validation mse = 1.521508
Epoch 16
Validation mse = 2.927624
Epoch 17
Validation mse = 3.255897
Epoch 18
Validation mse = 2.747685
Epoch 19
Validation mse = 1.771266
Epoch 20
Validation mse = 0.931487
Epoch 21
Validation mse = 0.584012
Epoch 22
Validation mse = 0.468543
Epoch 23
Validation mse = 0.504801
Epoch 24
Validation mse = 0.550294
Epoch 25
Validation mse = 0.610069
Epoch 26
Validation mse = 0.744054
Epoch 27
Validation mse = 0.707684
Epoch 28
Validation mse = 0.529312
Epoch 29
Validation mse = 0.389728
Epoch 30
Validation mse = 0.460563
Epoch 31
Validation mse = 0.619756
Epoch 32
Validation mse = 0.551552
Epoch 33
Validation mse = 0.493777
Epoch 34
Validation mse = 0.461820
Epoch 35
Validation mse = 0.486494
Epoch 36
Validation mse = 0.561121
Epoch 37
Validation mse = 0.611709
Epoch 38
Validation mse = 0.603115
Epoch 39
Validation mse = 0.525558
Epoch 40
Validation mse = 0.526018
Epoch 41
Validation mse = 0.548012
Epoch 42
Validation mse = 0.553315
Epoch 43
Validation mse = 0.503687
Epoch 44
Validation mse = 0.475626
Epoch 45
Validation mse = 0.501214
Epoch 46
Validation mse = 0.605856
Epoch 47
Validation mse = 0.626767
Epoch 48
Validation mse = 0.540056
Epoch 49
Validation mse = 0.501381
Epoch 50
Validation mse = 0.467375
Epoch 51
Validation mse = 0.473646
Epoch 52
Validation mse = 0.560792
Epoch 53
Validation mse = 0.653872
Epoch 54
Validation mse = 0.738047
Epoch 55
Validation mse = 0.588304
Epoch 56
Validation mse = 0.513218
Epoch 57
Validation mse = 0.555748
Epoch 58
Validation mse = 0.717727
Epoch 59
Validation mse = 0.736760
Epoch 60
Validation mse = 0.661885
Epoch 61
Validation mse = 0.552990
Epoch 62
Validation mse = 0.547648
Epoch 63
Validation mse = 0.613285
Epoch 64
Validation mse = 0.588278
Epoch 65
Validation mse = 0.565730
Epoch 66
Validation mse = 0.547748
Epoch 67
Validation mse = 0.494467
Epoch 68
Validation mse = 0.468169
Epoch 69
Validation mse = 0.480488
Epoch 70
Validation mse = 0.498779
Epoch 71
Validation mse = 0.478839
Epoch 72
Validation mse = 0.461680
Epoch 73
Validation mse = 0.480193
Epoch 74
Validation mse = 0.536001
Epoch 75
Validation mse = 0.635912
Epoch 76
Validation mse = 0.727659
Epoch 77
Validation mse = 0.780280
Epoch 78
Validation mse = 0.666550
Epoch 79
Validation mse = 0.658668
Epoch 80
Validation mse = 0.539835
Epoch 81
Validation mse = 0.518957
Epoch 82
Validation mse = 0.543741
Epoch 83
Validation mse = 0.544631
Epoch 84
Validation mse = 0.541228
Epoch 85
Validation mse = 0.532999
Epoch 86
Validation mse = 0.549263
Epoch 87
Validation mse = 0.620000
Epoch 88
Validation mse = 0.748208
Epoch 89
Validation mse = 0.788317
Epoch 90
Validation mse = 0.791950
Epoch 91
Validation mse = 0.660783
Epoch 92
Validation mse = 0.548430
Epoch 93
Validation mse = 0.511913
Epoch 94
Validation mse = 0.500283
Epoch 95
Validation mse = 0.495845
Epoch 96
Validation mse = 0.510553
Epoch 97
Validation mse = 0.547212
Epoch 98
Validation mse = 0.685272
Epoch 99
Validation mse = 0.816201
Epoch 100
Validation mse = 0.892969
Epoch 101
Validation mse = 0.779698
Epoch 102
Validation mse = 0.594156
Epoch 103
Validation mse = 0.529176
Epoch 104
Validation mse = 0.551040
Epoch 105
Validation mse = 0.559951
Epoch 106
Validation mse = 0.541454
Epoch 107
Validation mse = 0.541034
Epoch 108
Validation mse = 0.622574
Epoch 109
Validation mse = 0.797698
Epoch 110
Validation mse = 0.980426
Epoch 111
Validation mse = 0.951159
Epoch 112
Validation mse = 0.760986
Epoch 113
Validation mse = 0.658075
Epoch 114
Validation mse = 0.537170
Epoch 115
Validation mse = 0.516981
Epoch 116
Validation mse = 0.527464
Epoch 117
Validation mse = 0.523669
Epoch 118
Validation mse = 0.527087
Epoch 119
Validation mse = 0.628262
Epoch 120
Validation mse = 0.750787
Epoch 121
Validation mse = 0.797741
Epoch 122
Validation mse = 0.775020
Epoch 123
Validation mse = 0.700636
Epoch 124
Validation mse = 0.706527
Epoch 125
Validation mse = 0.720647
Epoch 126
Validation mse = 0.716528
Epoch 127
Validation mse = 0.732305
Epoch 128
Validation mse = 0.726186
Epoch 129
Validation mse = 0.722327
Epoch 130
Validation mse = 0.713586
Epoch 131
Validation mse = 0.748118
Epoch 132
Validation mse = 0.809798
Epoch 133
Validation mse = 0.866559
Epoch 134
Validation mse = 0.864112
Epoch 135
Validation mse = 0.895155
Epoch 136
Validation mse = 1.004770
Epoch 137
Validation mse = 0.934940
Epoch 138
Validation mse = 0.712436
Epoch 139
Validation mse = 0.582082
Epoch 140
Validation mse = 0.556152
Epoch 141
Validation mse = 0.559093
Epoch 142
Validation mse = 0.565042
Epoch 143
Validation mse = 0.587844
Epoch 144
Validation mse = 0.657180
Epoch 145
Validation mse = 0.699849
Epoch 146
Validation mse = 0.747460
Epoch 147
Validation mse = 0.794920
Epoch 148
Validation mse = 0.765487
Epoch 149
Validation mse = 0.713203
Model 1 best validation mse = 0.298454 on epoch 4
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test mse = 0.189662
Building model 2
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 23.896233
Epoch 1
Validation mse = 20.146968
Epoch 2
Validation mse = 12.499624
Epoch 3
Validation mse = 2.843256
Epoch 4
Validation mse = 2.348534
Epoch 5
Validation mse = 0.700242
Epoch 6
Validation mse = 0.993243
Epoch 7
Validation mse = 3.070359
Epoch 8
Validation mse = 4.507079
Epoch 9
Validation mse = 4.576630
Epoch 10
Validation mse = 3.437921
Epoch 11
Validation mse = 1.739529
Epoch 12
Validation mse = 0.617384
Epoch 13
Validation mse = 0.731335
Epoch 14
Validation mse = 1.767368
Epoch 15
Validation mse = 2.355054
Epoch 16
Validation mse = 1.256920
Epoch 17
Validation mse = 0.492556
Epoch 18
Validation mse = 0.532232
Epoch 19
Validation mse = 0.836094
Epoch 20
Validation mse = 1.065947
Epoch 21
Validation mse = 0.966090
Epoch 22
Validation mse = 0.748908
Epoch 23
Validation mse = 0.579687
Epoch 24
Validation mse = 0.482084
Epoch 25
Validation mse = 0.437936
Epoch 26
Validation mse = 0.448145
Epoch 27
Validation mse = 0.462227
Epoch 28
Validation mse = 0.464467
Epoch 29
Validation mse = 0.484478
Epoch 30
Validation mse = 0.499966
Epoch 31
Validation mse = 0.488779
Epoch 32
Validation mse = 0.549272
Epoch 33
Validation mse = 0.789067
Epoch 34
Validation mse = 0.964468
Epoch 35
Validation mse = 1.120304
Epoch 36
Validation mse = 1.009207
Epoch 37
Validation mse = 0.895310
Epoch 38
Validation mse = 0.702070
Epoch 39
Validation mse = 0.637929
Epoch 40
Validation mse = 0.572951
Epoch 41
Validation mse = 0.593413
Epoch 42
Validation mse = 0.605781
Epoch 43
Validation mse = 0.622463
Epoch 44
Validation mse = 0.581267
Epoch 45
Validation mse = 0.581924
Epoch 46
Validation mse = 0.601593
Epoch 47
Validation mse = 0.536744
Epoch 48
Validation mse = 0.529663
Epoch 49
Validation mse = 0.533533
Epoch 50
Validation mse = 0.555822
Epoch 51
Validation mse = 0.596176
Epoch 52
Validation mse = 0.664309
Epoch 53
Validation mse = 0.783683
Epoch 54
Validation mse = 1.006604
Epoch 55
Validation mse = 1.075961
Epoch 56
Validation mse = 0.943409
Epoch 57
Validation mse = 0.757911
Epoch 58
Validation mse = 0.702232
Epoch 59
Validation mse = 0.682238
Epoch 60
Validation mse = 0.710803
Epoch 61
Validation mse = 0.816153
Epoch 62
Validation mse = 0.856237
Epoch 63
Validation mse = 0.873044
Epoch 64
Validation mse = 0.908397
Epoch 65
Validation mse = 0.956052
Epoch 66
Validation mse = 0.994910
Epoch 67
Validation mse = 0.965887
Epoch 68
Validation mse = 0.953024
Epoch 69
Validation mse = 0.985967
Epoch 70
Validation mse = 1.120752
Epoch 71
Validation mse = 1.192508
Epoch 72
Validation mse = 1.150165
Epoch 73
Validation mse = 0.967073
Epoch 74
Validation mse = 0.786209
Epoch 75
Validation mse = 0.706950
Epoch 76
Validation mse = 0.718254
Epoch 77
Validation mse = 0.706393
Epoch 78
Validation mse = 0.723335
Epoch 79
Validation mse = 0.803831
Epoch 80
Validation mse = 0.949395
Epoch 81
Validation mse = 1.089216
Epoch 82
Validation mse = 1.244106
Epoch 83
Validation mse = 1.220873
Epoch 84
Validation mse = 1.071374
Epoch 85
Validation mse = 0.986863
Epoch 86
Validation mse = 0.891899
Epoch 87
Validation mse = 0.895555
Epoch 88
Validation mse = 0.847203
Epoch 89
Validation mse = 0.797571
Epoch 90
Validation mse = 0.733503
Epoch 91
Validation mse = 0.744415
Epoch 92
Validation mse = 0.773201
Epoch 93
Validation mse = 0.792450
Epoch 94
Validation mse = 0.836913
Epoch 95
Validation mse = 0.965168
Epoch 96
Validation mse = 1.133028
Epoch 97
Validation mse = 1.187873
Epoch 98
Validation mse = 1.056726
Epoch 99
Validation mse = 0.874136
Epoch 100
Validation mse = 0.771882
Epoch 101
Validation mse = 0.712692
Epoch 102
Validation mse = 0.636965
Epoch 103
Validation mse = 0.612160
Epoch 104
Validation mse = 0.625422
Epoch 105
Validation mse = 0.700854
Epoch 106
Validation mse = 0.816618
Epoch 107
Validation mse = 1.087795
Epoch 108
Validation mse = 1.245768
Epoch 109
Validation mse = 1.212710
Epoch 110
Validation mse = 1.067198
Epoch 111
Validation mse = 0.925423
Epoch 112
Validation mse = 0.763514
Epoch 113
Validation mse = 0.702537
Epoch 114
Validation mse = 0.663331
Epoch 115
Validation mse = 0.717455
Epoch 116
Validation mse = 0.916292
Epoch 117
Validation mse = 1.056436
Epoch 118
Validation mse = 1.166788
Epoch 119
Validation mse = 1.101813
Epoch 120
Validation mse = 1.040929
Epoch 121
Validation mse = 1.008544
Epoch 122
Validation mse = 0.865659
Epoch 123
Validation mse = 0.761758
Epoch 124
Validation mse = 0.727435
Epoch 125
Validation mse = 0.679982
Epoch 126
Validation mse = 0.647689
Epoch 127
Validation mse = 0.656803
Epoch 128
Validation mse = 0.733850
Epoch 129
Validation mse = 0.964615
Epoch 130
Validation mse = 1.272155
Epoch 131
Validation mse = 1.313119
Epoch 132
Validation mse = 1.091674
Epoch 133
Validation mse = 0.936461
Epoch 134
Validation mse = 0.816310
Epoch 135
Validation mse = 0.786785
Epoch 136
Validation mse = 0.832668
Epoch 137
Validation mse = 0.893337
Epoch 138
Validation mse = 0.936663
Epoch 139
Validation mse = 1.068151
Epoch 140
Validation mse = 1.065015
Epoch 141
Validation mse = 1.045723
Epoch 142
Validation mse = 0.910492
Epoch 143
Validation mse = 0.900448
Epoch 144
Validation mse = 0.915883
Epoch 145
Validation mse = 0.892135
Epoch 146
Validation mse = 0.855867
Epoch 147
Validation mse = 0.937059
Epoch 148
Validation mse = 0.987875
Epoch 149
Validation mse = 0.900735
Model 2 best validation mse = 0.437936 on epoch 25
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 2 test mse = 0.900766
Ensemble test mse = 0.217575
1-fold cross validation
	Seed 0 ==> test mse = 0.217575
Overall test mse = 0.217575 +/- 0.000000
Overall test Cindex = 0.666667 +/- 0.000000 
Elapsed time = 0:01:15
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Command line
python train.py --data_path ./toy_dataset/novel_pair_0_train.csv --separate_val_path ./toy_dataset/novel_pair_0_val.csv --separate_test_path ./toy_dataset/novel_pair_0_test.csv --metric mse --dataset_type regression --save_dir regression_150_newprot_pre --target_columns label --epochs 150 --ensemble_size 3 --num_folds 1 --batch_size 50 --aggregation mean --dropout 0.1 --save_preds
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.5,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'beta': 5,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './toy_dataset/novel_pair_0_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.1,
 'empty_cache': False,
 'ensemble_size': 3,
 'epochs': 150,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'kernel_size': 7,
 'lamp_lr': 0.0025,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'mse',
 'metrics': ['mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'prot_1d_out': 64,
 'prot_1dcnn_num': 3,
 'prot_hidden': 128,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': 'regression_150_newprot_pre',
 'save_preds': True,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './toy_dataset/novel_pair_0_test.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': './toy_dataset/novel_pair_0_val.csv',
 'sequence_length': 500,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['label'],
 'target_weights': None,
 'task_names': ['label'],
 'tau': (0.0, 5.0),
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'vocab_size': 31,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 5 | train size = 5 | val size = 4 | test size = 4
Fitting scaler
Building model 0
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 22.650464
Epoch 1
Validation mse = 18.804529
Epoch 2
Validation mse = 14.646093
Epoch 3
Validation mse = 9.481290
Epoch 4
Validation mse = 6.941070
Epoch 5
Validation mse = 4.598755
Epoch 6
Validation mse = 2.819784
Epoch 7
Validation mse = 1.079795
Epoch 8
Validation mse = 0.016544
Epoch 9
Validation mse = 1.057661
Epoch 10
Validation mse = 3.187564
Epoch 11
Validation mse = 2.127336
Epoch 12
Validation mse = 0.501747
Epoch 13
Validation mse = 0.004037
Epoch 14
Validation mse = 0.100279
Epoch 15
Validation mse = 0.133461
Epoch 16
Validation mse = 0.033799
Epoch 17
Validation mse = 0.042934
Epoch 18
Validation mse = 0.453662
Epoch 19
Validation mse = 1.171022
Epoch 20
Validation mse = 1.456044
Epoch 21
Validation mse = 1.374974
Epoch 22
Validation mse = 0.749116
Epoch 23
Validation mse = 0.243931
Epoch 24
Validation mse = 0.030884
Epoch 25
Validation mse = 0.004851
Epoch 26
Validation mse = 0.010461
Epoch 27
Validation mse = 0.009546
Epoch 28
Validation mse = 0.003236
Epoch 29
Validation mse = 0.026484
Epoch 30
Validation mse = 0.118402
Epoch 31
Validation mse = 0.359793
Epoch 32
Validation mse = 0.773467
Epoch 33
Validation mse = 1.158630
Epoch 34
Validation mse = 1.291696
Epoch 35
Validation mse = 0.971458
Epoch 36
Validation mse = 0.508565
Epoch 37
Validation mse = 0.125234
Epoch 38
Validation mse = 0.009849
Epoch 39
Validation mse = 0.009708
Epoch 40
Validation mse = 0.031438
Epoch 41
Validation mse = 0.047592
Epoch 42
Validation mse = 0.049407
Epoch 43
Validation mse = 0.038050
Epoch 44
Validation mse = 0.017391
Epoch 45
Validation mse = 0.003616
Epoch 46
Validation mse = 0.045799
Epoch 47
Validation mse = 0.192366
Epoch 48
Validation mse = 0.297575
Epoch 49
Validation mse = 0.429353
Epoch 50
Validation mse = 0.487312
Epoch 51
Validation mse = 0.504946
Epoch 52
Validation mse = 0.484337
Epoch 53
Validation mse = 0.370271
Epoch 54
Validation mse = 0.278577
Epoch 55
Validation mse = 0.199556
Epoch 56
Validation mse = 0.142779
Epoch 57
Validation mse = 0.090347
Epoch 58
Validation mse = 0.058876
Epoch 59
Validation mse = 0.048336
Epoch 60
Validation mse = 0.058719
Epoch 61
Validation mse = 0.089571
Epoch 62
Validation mse = 0.106234
Epoch 63
Validation mse = 0.120283
Epoch 64
Validation mse = 0.178641
Epoch 65
Validation mse = 0.203497
Epoch 66
Validation mse = 0.254724
Epoch 67
Validation mse = 0.301650
Epoch 68
Validation mse = 0.328618
Epoch 69
Validation mse = 0.253383
Epoch 70
Validation mse = 0.236788
Epoch 71
Validation mse = 0.254327
Epoch 72
Validation mse = 0.271544
Epoch 73
Validation mse = 0.323948
Epoch 74
Validation mse = 0.345434
Epoch 75
Validation mse = 0.351841
Epoch 76
Validation mse = 0.275851
Epoch 77
Validation mse = 0.218004
Epoch 78
Validation mse = 0.166893
Epoch 79
Validation mse = 0.140355
Epoch 80
Validation mse = 0.164033
Epoch 81
Validation mse = 0.155988
Epoch 82
Validation mse = 0.160594
Epoch 83
Validation mse = 0.167315
Epoch 84
Validation mse = 0.200016
Epoch 85
Validation mse = 0.272929
Epoch 86
Validation mse = 0.208635
Epoch 87
Validation mse = 0.112538
Epoch 88
Validation mse = 0.045550
Epoch 89
Validation mse = 0.025856
Epoch 90
Validation mse = 0.018386
Epoch 91
Validation mse = 0.019970
Epoch 92
Validation mse = 0.028919
Epoch 93
Validation mse = 0.037005
Epoch 94
Validation mse = 0.047165
Epoch 95
Validation mse = 0.058964
Epoch 96
Validation mse = 0.054682
Epoch 97
Validation mse = 0.060552
Epoch 98
Validation mse = 0.084965
Epoch 99
Validation mse = 0.091591
Epoch 100
Validation mse = 0.115528
Epoch 101
Validation mse = 0.165314
Epoch 102
Validation mse = 0.196781
Epoch 103
Validation mse = 0.231406
Epoch 104
Validation mse = 0.241859
Epoch 105
Validation mse = 0.259013
Epoch 106
Validation mse = 0.230010
Epoch 107
Validation mse = 0.222093
Epoch 108
Validation mse = 0.236222
Epoch 109
Validation mse = 0.230390
Epoch 110
Validation mse = 0.201754
Epoch 111
Validation mse = 0.162834
Epoch 112
Validation mse = 0.146252
Epoch 113
Validation mse = 0.123511
Epoch 114
Validation mse = 0.090993
Epoch 115
Validation mse = 0.067024
Epoch 116
Validation mse = 0.058158
Epoch 117
Validation mse = 0.073178
Epoch 118
Validation mse = 0.066573
Epoch 119
Validation mse = 0.074054
Epoch 120
Validation mse = 0.097144
Epoch 121
Validation mse = 0.143633
Epoch 122
Validation mse = 0.197665
Epoch 123
Validation mse = 0.277480
Epoch 124
Validation mse = 0.288495
Epoch 125
Validation mse = 0.242674
Epoch 126
Validation mse = 0.227479
Epoch 127
Validation mse = 0.213558
Epoch 128
Validation mse = 0.177567
Epoch 129
Validation mse = 0.153509
Epoch 130
Validation mse = 0.121367
Epoch 131
Validation mse = 0.099113
Epoch 132
Validation mse = 0.079739
Epoch 133
Validation mse = 0.075892
Epoch 134
Validation mse = 0.089986
Epoch 135
Validation mse = 0.121079
Epoch 136
Validation mse = 0.139630
Epoch 137
Validation mse = 0.135820
Epoch 138
Validation mse = 0.150094
Epoch 139
Validation mse = 0.167416
Epoch 140
Validation mse = 0.180707
Epoch 141
Validation mse = 0.182877
Epoch 142
Validation mse = 0.163116
Epoch 143
Validation mse = 0.153418
Epoch 144
Validation mse = 0.146613
Epoch 145
Validation mse = 0.133332
Epoch 146
Validation mse = 0.110308
Epoch 147
Validation mse = 0.091434
Epoch 148
Validation mse = 0.091585
Epoch 149
Validation mse = 0.105893
Model 0 best validation mse = 0.003236 on epoch 28
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test mse = 0.048141
Building model 1
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 20.924387
Epoch 1
Validation mse = 16.139413
Epoch 2
Validation mse = 12.359226
Epoch 3
Validation mse = 8.886031
Epoch 4
Validation mse = 5.543181
Epoch 5
Validation mse = 2.970951
Epoch 6
Validation mse = 0.629610
Epoch 7
Validation mse = 0.049394
Epoch 8
Validation mse = 1.543541
Epoch 9
Validation mse = 3.518410
Epoch 10
Validation mse = 2.365763
Epoch 11
Validation mse = 0.580208
Epoch 12
Validation mse = 0.016767
Epoch 13
Validation mse = 0.101270
Epoch 14
Validation mse = 0.169534
Epoch 15
Validation mse = 0.083012
Epoch 16
Validation mse = 0.004130
Epoch 17
Validation mse = 0.116073
Epoch 18
Validation mse = 0.257788
Epoch 19
Validation mse = 0.352637
Epoch 20
Validation mse = 0.379754
Epoch 21
Validation mse = 0.187078
Epoch 22
Validation mse = 0.040806
Epoch 23
Validation mse = 0.012696
Epoch 24
Validation mse = 0.011236
Epoch 25
Validation mse = 0.053146
Epoch 26
Validation mse = 0.167936
Epoch 27
Validation mse = 0.297663
Epoch 28
Validation mse = 0.275826
Epoch 29
Validation mse = 0.261251
Epoch 30
Validation mse = 0.171924
Epoch 31
Validation mse = 0.119438
Epoch 32
Validation mse = 0.089896
Epoch 33
Validation mse = 0.104146
Epoch 34
Validation mse = 0.088310
Epoch 35
Validation mse = 0.161927
Epoch 36
Validation mse = 0.249136
Epoch 37
Validation mse = 0.296905
Epoch 38
Validation mse = 0.325952
Epoch 39
Validation mse = 0.361623
Epoch 40
Validation mse = 0.397447
Epoch 41
Validation mse = 0.477012
Epoch 42
Validation mse = 0.502769
Epoch 43
Validation mse = 0.510687
Epoch 44
Validation mse = 0.375500
Epoch 45
Validation mse = 0.212196
Epoch 46
Validation mse = 0.078856
Epoch 47
Validation mse = 0.018510
Epoch 48
Validation mse = 0.010538
Epoch 49
Validation mse = 0.006952
Epoch 50
Validation mse = 0.011351
Epoch 51
Validation mse = 0.042807
Epoch 52
Validation mse = 0.082239
Epoch 53
Validation mse = 0.123871
Epoch 54
Validation mse = 0.150373
Epoch 55
Validation mse = 0.232042
Epoch 56
Validation mse = 0.239703
Epoch 57
Validation mse = 0.211153
Epoch 58
Validation mse = 0.148105
Epoch 59
Validation mse = 0.117140
Epoch 60
Validation mse = 0.075873
Epoch 61
Validation mse = 0.076192
Epoch 62
Validation mse = 0.093748
Epoch 63
Validation mse = 0.151790
Epoch 64
Validation mse = 0.255952
Epoch 65
Validation mse = 0.211670
Epoch 66
Validation mse = 0.160895
Epoch 67
Validation mse = 0.116143
Epoch 68
Validation mse = 0.105394
Epoch 69
Validation mse = 0.119889
Epoch 70
Validation mse = 0.145399
Epoch 71
Validation mse = 0.077786
Epoch 72
Validation mse = 0.063655
Epoch 73
Validation mse = 0.060988
Epoch 74
Validation mse = 0.063312
Epoch 75
Validation mse = 0.090575
Epoch 76
Validation mse = 0.125940
Epoch 77
Validation mse = 0.229370
Epoch 78
Validation mse = 0.370602
Epoch 79
Validation mse = 0.411552
Epoch 80
Validation mse = 0.320152
Epoch 81
Validation mse = 0.273806
Epoch 82
Validation mse = 0.173299
Epoch 83
Validation mse = 0.081664
Epoch 84
Validation mse = 0.050916
Epoch 85
Validation mse = 0.058104
Epoch 86
Validation mse = 0.066500
Epoch 87
Validation mse = 0.083451
Epoch 88
Validation mse = 0.142826
Epoch 89
Validation mse = 0.143633
Epoch 90
Validation mse = 0.160393
Epoch 91
Validation mse = 0.241897
Epoch 92
Validation mse = 0.354255
Epoch 93
Validation mse = 0.474102
Epoch 94
Validation mse = 0.600788
Epoch 95
Validation mse = 0.365460
Epoch 96
Validation mse = 0.169371
Epoch 97
Validation mse = 0.078001
Epoch 98
Validation mse = 0.074402
Epoch 99
Validation mse = 0.110255
Epoch 100
Validation mse = 0.212528
Epoch 101
Validation mse = 0.360042
Epoch 102
Validation mse = 0.528037
Epoch 103
Validation mse = 0.552249
Epoch 104
Validation mse = 0.437913
Epoch 105
Validation mse = 0.345649
Epoch 106
Validation mse = 0.207030
Epoch 107
Validation mse = 0.053524
Epoch 108
Validation mse = 0.014069
Epoch 109
Validation mse = 0.006579
Epoch 110
Validation mse = 0.006385
Epoch 111
Validation mse = 0.009171
Epoch 112
Validation mse = 0.015334
Epoch 113
Validation mse = 0.026028
Epoch 114
Validation mse = 0.052753
Epoch 115
Validation mse = 0.123604
Epoch 116
Validation mse = 0.188582
Epoch 117
Validation mse = 0.206527
Epoch 118
Validation mse = 0.143470
Epoch 119
Validation mse = 0.112051
Epoch 120
Validation mse = 0.082191
Epoch 121
Validation mse = 0.036179
Epoch 122
Validation mse = 0.006321
Epoch 123
Validation mse = 0.032903
Epoch 124
Validation mse = 0.070120
Epoch 125
Validation mse = 0.074800
Epoch 126
Validation mse = 0.026374
Epoch 127
Validation mse = 0.014004
Epoch 128
Validation mse = 0.120508
Epoch 129
Validation mse = 0.343969
Epoch 130
Validation mse = 0.725575
Epoch 131
Validation mse = 1.163397
Epoch 132
Validation mse = 1.176517
Epoch 133
Validation mse = 0.897142
Epoch 134
Validation mse = 0.298697
Epoch 135
Validation mse = 0.018830
Epoch 136
Validation mse = 0.056165
Epoch 137
Validation mse = 0.211233
Epoch 138
Validation mse = 0.306617
Epoch 139
Validation mse = 0.302368
Epoch 140
Validation mse = 0.203224
Epoch 141
Validation mse = 0.100735
Epoch 142
Validation mse = 0.015572
Epoch 143
Validation mse = 0.036034
Epoch 144
Validation mse = 0.210353
Epoch 145
Validation mse = 0.479663
Epoch 146
Validation mse = 0.790790
Epoch 147
Validation mse = 0.909834
Epoch 148
Validation mse = 0.936998
Epoch 149
Validation mse = 0.786776
Model 1 best validation mse = 0.004130 on epoch 16
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 1 test mse = 0.048798
Building model 2
InteractionModel(
  (embedding_xt): Embedding(31, 128)
  (conv_in): Conv1d(500, 64, kernel_size=(1,), stride=(1,))
  (convs): ModuleList(
    (0): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
    (2): Conv1d(128, 256, kernel_size=(7,), stride=(1,), padding=(3,))
  )
  (rnns): ModuleList(
    (0): GRU(64, 64, batch_first=True, bidirectional=True)
    (1): GRU(64, 64, batch_first=True, bidirectional=True)
    (2): GRU(64, 64, batch_first=True, bidirectional=True)
  )
  (fc1_xt): Linear(in_features=8192, out_features=300, bias=True)
  (fc_mg): Linear(in_features=2048, out_features=300, bias=True)
  (fc_residual_connection): Linear(in_features=128, out_features=64, bias=True)
  (relu): ReLU()
  (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
  (do): Dropout(p=0.1, inplace=False)
  (CAB): CrossAttentionBlock(
    (att): AttentionBlock(
      (f_q): Linear(in_features=300, out_features=300, bias=True)
      (f_k): Linear(in_features=300, out_features=300, bias=True)
      (f_v): Linear(in_features=300, out_features=300, bias=True)
      (fc): Linear(in_features=300, out_features=300, bias=True)
      (do): Dropout(p=0.1, inplace=False)
    )
  )
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.1, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.1, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 4,672,073
Moving model to cuda
Epoch 0
Validation mse = 19.237778
Epoch 1
Validation mse = 14.445660
Epoch 2
Validation mse = 9.443363
Epoch 3
Validation mse = 5.095502
Epoch 4
Validation mse = 2.109111
Epoch 5
Validation mse = 0.451345
Epoch 6
Validation mse = 0.030346
Epoch 7
Validation mse = 0.224814
Epoch 8
Validation mse = 0.526283
Epoch 9
Validation mse = 0.604819
Epoch 10
Validation mse = 0.427001
Epoch 11
Validation mse = 0.063868
Epoch 12
Validation mse = 0.043995
Epoch 13
Validation mse = 0.055812
Epoch 14
Validation mse = 0.089743
Epoch 15
Validation mse = 0.155539
Epoch 16
Validation mse = 0.386799
Epoch 17
Validation mse = 0.564231
Epoch 18
Validation mse = 0.381958
Epoch 19
Validation mse = 0.185776
Epoch 20
Validation mse = 0.109190
Epoch 21
Validation mse = 0.060987
Epoch 22
Validation mse = 0.099016
Epoch 23
Validation mse = 0.168060
Epoch 24
Validation mse = 0.259198
Epoch 25
Validation mse = 0.428446
Epoch 26
Validation mse = 0.442668
Epoch 27
Validation mse = 0.291338
Epoch 28
Validation mse = 0.057646
Epoch 29
Validation mse = 0.005814
Epoch 30
Validation mse = 0.016065
Epoch 31
Validation mse = 0.028266
Epoch 32
Validation mse = 0.013339
Epoch 33
Validation mse = 0.009227
Epoch 34
Validation mse = 0.079825
Epoch 35
Validation mse = 0.248283
Epoch 36
Validation mse = 0.496179
Epoch 37
Validation mse = 0.574534
Epoch 38
Validation mse = 0.460668
Epoch 39
Validation mse = 0.277678
Epoch 40
Validation mse = 0.143456
Epoch 41
Validation mse = 0.018574
Epoch 42
Validation mse = 0.014149
Epoch 43
Validation mse = 0.051999
Epoch 44
Validation mse = 0.043060
Epoch 45
Validation mse = 0.003490
Epoch 46
Validation mse = 0.090011
Epoch 47
Validation mse = 0.340508
Epoch 48
Validation mse = 0.668624
Epoch 49
Validation mse = 0.909305
Epoch 50
Validation mse = 0.806872
Epoch 51
Validation mse = 0.617866
Epoch 52
Validation mse = 0.412453
Epoch 53
Validation mse = 0.219291
Epoch 54
Validation mse = 0.108976
Epoch 55
Validation mse = 0.053410
Epoch 56
Validation mse = 0.030850
Epoch 57
Validation mse = 0.026040
Epoch 58
Validation mse = 0.030508
Epoch 59
Validation mse = 0.053267
Epoch 60
Validation mse = 0.097072
Epoch 61
Validation mse = 0.166179
Epoch 62
Validation mse = 0.210972
Epoch 63
Validation mse = 0.255315
Epoch 64
Validation mse = 0.318118
Epoch 65
Validation mse = 0.408640
Epoch 66
Validation mse = 0.503317
Epoch 67
Validation mse = 0.420560
Epoch 68
Validation mse = 0.289641
Epoch 69
Validation mse = 0.158495
Epoch 70
Validation mse = 0.077192
Epoch 71
Validation mse = 0.036664
Epoch 72
Validation mse = 0.027370
Epoch 73
Validation mse = 0.037002
Epoch 74
Validation mse = 0.056567
Epoch 75
Validation mse = 0.103769
Epoch 76
Validation mse = 0.169612
Epoch 77
Validation mse = 0.223728
Epoch 78
Validation mse = 0.260760
Epoch 79
Validation mse = 0.304841
Epoch 80
Validation mse = 0.331655
Epoch 81
Validation mse = 0.334804
Epoch 82
Validation mse = 0.353147
Epoch 83
Validation mse = 0.392255
Epoch 84
Validation mse = 0.346198
Epoch 85
Validation mse = 0.299614
Epoch 86
Validation mse = 0.245168
Epoch 87
Validation mse = 0.201542
Epoch 88
Validation mse = 0.161388
Epoch 89
Validation mse = 0.117996
Epoch 90
Validation mse = 0.067497
Epoch 91
Validation mse = 0.054586
Epoch 92
Validation mse = 0.053236
Epoch 93
Validation mse = 0.053826
Epoch 94
Validation mse = 0.056701
Epoch 95
Validation mse = 0.078021
Epoch 96
Validation mse = 0.107756
Epoch 97
Validation mse = 0.131994
Epoch 98
Validation mse = 0.137857
Epoch 99
Validation mse = 0.147602
Epoch 100
Validation mse = 0.160541
Epoch 101
Validation mse = 0.191704
Epoch 102
Validation mse = 0.221590
Epoch 103
Validation mse = 0.230807
Epoch 104
Validation mse = 0.229917
Epoch 105
Validation mse = 0.217977
Epoch 106
Validation mse = 0.185590
Epoch 107
Validation mse = 0.151801
Epoch 108
Validation mse = 0.139607
Epoch 109
Validation mse = 0.135023
Epoch 110
Validation mse = 0.144108
Epoch 111
Validation mse = 0.146416
Epoch 112
Validation mse = 0.113309
Epoch 113
Validation mse = 0.100442
Epoch 114
Validation mse = 0.092660
Epoch 115
Validation mse = 0.094366
Epoch 116
Validation mse = 0.110695
Epoch 117
Validation mse = 0.150563
Epoch 118
Validation mse = 0.201131
Epoch 119
Validation mse = 0.260307
Epoch 120
Validation mse = 0.353925
Epoch 121
Validation mse = 0.451090
Epoch 122
Validation mse = 0.536751
Epoch 123
Validation mse = 0.558549
Epoch 124
Validation mse = 0.512197
Epoch 125
Validation mse = 0.480552
Epoch 126
Validation mse = 0.370169
Epoch 127
Validation mse = 0.276746
Epoch 128
Validation mse = 0.202402
Epoch 129
Validation mse = 0.166976
Epoch 130
Validation mse = 0.134038
Epoch 131
Validation mse = 0.127529
Epoch 132
Validation mse = 0.130795
Epoch 133
Validation mse = 0.133448
Epoch 134
Validation mse = 0.126389
Epoch 135
Validation mse = 0.116237
Epoch 136
Validation mse = 0.098593
Epoch 137
Validation mse = 0.102649
Epoch 138
Validation mse = 0.095097
Epoch 139
Validation mse = 0.088168
Epoch 140
Validation mse = 0.106741
Epoch 141
Validation mse = 0.131429
Epoch 142
Validation mse = 0.133165
Epoch 143
Validation mse = 0.144932
Epoch 144
Validation mse = 0.157784
Epoch 145
Validation mse = 0.160943
Epoch 146
Validation mse = 0.160051
Epoch 147
Validation mse = 0.175763
Epoch 148
Validation mse = 0.155444
Epoch 149
Validation mse = 0.145247
Model 2 best validation mse = 0.003490 on epoch 45
Loading pretrained parameter "embedding_xt.weight".
Loading pretrained parameter "conv_in.weight".
Loading pretrained parameter "conv_in.bias".
Loading pretrained parameter "convs.0.weight".
Loading pretrained parameter "convs.0.bias".
Loading pretrained parameter "convs.1.weight".
Loading pretrained parameter "convs.1.bias".
Loading pretrained parameter "convs.2.weight".
Loading pretrained parameter "convs.2.bias".
Loading pretrained parameter "rnns.0.weight_ih_l0".
Loading pretrained parameter "rnns.0.weight_hh_l0".
Loading pretrained parameter "rnns.0.bias_ih_l0".
Loading pretrained parameter "rnns.0.bias_hh_l0".
Loading pretrained parameter "rnns.0.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.0.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.0.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.0.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.1.weight_ih_l0".
Loading pretrained parameter "rnns.1.weight_hh_l0".
Loading pretrained parameter "rnns.1.bias_ih_l0".
Loading pretrained parameter "rnns.1.bias_hh_l0".
Loading pretrained parameter "rnns.1.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.1.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.1.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.1.bias_hh_l0_reverse".
Loading pretrained parameter "rnns.2.weight_ih_l0".
Loading pretrained parameter "rnns.2.weight_hh_l0".
Loading pretrained parameter "rnns.2.bias_ih_l0".
Loading pretrained parameter "rnns.2.bias_hh_l0".
Loading pretrained parameter "rnns.2.weight_ih_l0_reverse".
Loading pretrained parameter "rnns.2.weight_hh_l0_reverse".
Loading pretrained parameter "rnns.2.bias_ih_l0_reverse".
Loading pretrained parameter "rnns.2.bias_hh_l0_reverse".
Loading pretrained parameter "fc1_xt.weight".
Loading pretrained parameter "fc1_xt.bias".
Loading pretrained parameter "fc_mg.weight".
Loading pretrained parameter "fc_mg.bias".
Loading pretrained parameter "fc_residual_connection.weight".
Loading pretrained parameter "fc_residual_connection.bias".
Loading pretrained parameter "norm.weight".
Loading pretrained parameter "norm.bias".
Loading pretrained parameter "CAB.att.f_q.weight".
Loading pretrained parameter "CAB.att.f_q.bias".
Loading pretrained parameter "CAB.att.f_k.weight".
Loading pretrained parameter "CAB.att.f_k.bias".
Loading pretrained parameter "CAB.att.f_v.weight".
Loading pretrained parameter "CAB.att.f_v.bias".
Loading pretrained parameter "CAB.att.fc.weight".
Loading pretrained parameter "CAB.att.fc.bias".
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 2 test mse = 0.118915
Ensemble test mse = 0.060204
1-fold cross validation
	Seed 0 ==> test mse = 0.060204
Overall test mse = 0.060204 +/- 0.000000
Overall test Cindex = 0.500000 +/- 0.000000 
Elapsed time = 0:00:46
